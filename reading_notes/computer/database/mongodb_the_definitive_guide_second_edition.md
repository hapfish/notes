
# mongodb_the_definitive_guide_second_edition.md  

[美] Kristina Chodorow 著  
邓强  王明辉 译  

与传统的关系型数据库不同, MongoDB是一种面向文档的数据库.  

# 目录 

- 第一部分 MongoDB介绍  1 - 4章  
- 第二部分 设计应用  5 - 8 章  
- 第三部分 复制  9 - 12 章  
- 第四部分 分片 13- 16 章  
- 第五部分 应用管理  17 - 19 章  
- 第六部分 服务器管理  20 - 23 章   


# 序  

MongoDB具有支撑今天主流Web应用的关键功能: 索引, 复制, 分片, 丰富的查询语法, 特别灵活的数据模型. 与此同时还不牺牲效率.  


# 前言  

` <<MongoDB权威指南(第二版)>> ` Kristina Chodorow著(O'Reilly, 2013). 版权所有 978-1-449-34468-9.  

Safari在线图书(www.safaribooksonline.com) 是应需而变的数字图书馆, 它同时以图书和视频的形式出版世界顶级技术和商务作家的专业作品.  

中国: 北京市西城区西直门南大街2号成铭大厦C座807室(100035)  

# 第一章 MongoDB简介  

MongoDB是一款强大, 灵活, 且易于扩展的通用型数据库. 它能扩展出非常多的功能, 如二级索引(secondary index), 范围查询(range query), 排序, 聚合(aggregation), 以及地理空间索引(geospatial index).  

MongoDB是一个面向文档(document-oriented)的数据库, 而不是关系型数据库. 不采用关系型数据库主要是为了获得更好的扩展性.  

面向文档的数据库不再有"行"(row)的概念, 取而代之的是更为灵活的"文档"(document)模型. 不再有预定义模式(predefined scheme): 文档的键(key)和值(value)不再是固定的类型和大小.  

纵向扩展(scale up)和横向扩展(scale out)之间的选择: 纵向扩展就是使用计算能力更强的计算机, 而横向扩展就是通过分区将数据分散到更多机器上.  MongoDB的设计采用横向扩展. MongoDB能够自动处理跨集群的数据和负载, 自动重新分配文档, 以及将用户请求路由到正确的机器上.  


MongoDB作为一款通用型数据库, 除了能够创建, 读取, 更新和删除数据之外, 还提供一系列不断扩展的独特功能.  
- 索引(indexing) 支持通用二级索引, 允许多种快速查询, 且提供唯一索引, 复合索引, 地理空间索引, 以及全文索引.  
- 聚合(aggregation) 支持"聚合管道"(aggregation pipeline). 用户能够通过简单的片段创建复杂的聚合, 并通过数据库自动化.  
- 特殊的集合类型 支持在时间有限的集合, 适用于那些将在某个时刻过期的数据, 如会话(session).  
- 文件存储(file storage) 支持一种非常易用的协议, 用于存储大文件和文件元数据.  

MongoDB并不具有一些在关系型数据库中很普遍的功能, 如连接(join)和复杂和多行事务(multirow transaction). 省略这些功能是出于架构上的考虑(为了得到更好的扩展性), 因为分布式系统中这两个功能难以高效地实现.  

MongoDB能对文档进行动态填充(dynamic padding).也能预分配数据文件以利用额外的空间来换取稳定的性能.  MongoDB把尽可能多的内存用作缓存(cache), 试图为每次查询自动选择正确的索引.    


# 第二章  MongoDB基础知识  


基本概念  
- 文档是MongoDB中数据的基本单元, 非常类似于关系型数据库管理系统中的行, 但更具表现力.  
- 类似地, 集合(collection)可以看作是一个拥有动态模式的(dynamic schema)的表.  
- MongoDB的一个实例可以拥有多个互相独立的数据库(database), 每一个数据库都拥有自己的集合.  
- 每一个文档都有一个特殊的键"_id", 这个键在文档所属的集合中是唯一的.  
- MongoDB自带了一个简单但功能强大的JavaScript Shell, 可用于管理MongoDB的实例或数据操作.  


映射(map), 散列(hash), 字典(dictionary)  

MongoDB的文档不能有重复的键.  

集合就是一组文档. 如果将MongoDB中的一个文档比喻为关系数据库中的一行, 那么一个集合就相当于一张表.  

集合是动态模式的, 这意味着一个集合里面的文档可以是各式各样的.  

没有必要区分不同类型的模式, 使用多个集合的原因思考:  
- 如果把各种各样的文档不加区分地放在同一个集合里, 无论对开发者还是对管理员来说都是噩梦.  
- 在一个集合里查询特定类型的文档在速度上也很不划算, 分开查询多个集合要快得多. 
- 把同种类型的文档放在一个集合里, 数据会更加集中.  
- 创建索引时, 需要使用文档的附加结构(特别是创建唯一索引时).  


集合名可以是满足下列条件的任意UTF-8字符串.  
- 集合名不能是空字符串("")  
- 集合名不能包括\0字符(空字符), 这个字符表示集合名的结束  
- 集合名不能以"system."开头, 这是为系统集合保留的前缀. system.users保存着数据库的用户信息, system.namespace集合保存着所有数据库集合的信息    
- 用户创建的集合不能在集合名中包含保留字符"$"  


组织集合的一种惯例是使用"."分割不同命名空间的子集合.  

数据库名可以是满足以下条件的任意UTF-8字符串. 
- 不能是空字符串("").  
- 不得含有 / \ . " * < > : | ? $ (一个空格) \0 (空字符串)  . 基本上只能使用ASCII中的字母和数字.  
- 数据库名区分大小写, 即便是在不区分大小写的文件系统中也是如此. 简单起见, 数据库名应全部小写.  
- 数据库名最多为64字节.  

数据库最终会变成文件系统里的文件, 而数据库名就是相应的文件名, 这是数据库名有如此多限制的原因.  




  
 



























